id: wsdl-api
info:
  name: WSDL API - Detect
  author: jarijaas
  severity: info
  description: WSDL API was detected.
  tags: exposure,api
http:
  - method: GET
    path:
      - "{{BaseURL}}/?wsdl"
    redirects: true
    max-redirects: 10
    extractors:
      - type: regex
        name: wsdl_def
        part: body
        group: 0
        internal: true
        regex:
          - '(?i)wsdl:definitions'
      - type: dsl
        dsl:
          - 'len(wsdl_def) > 0 ? to_value_group("api.spec.wsdl", wsdl_def) : ""'
