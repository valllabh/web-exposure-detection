id: wadl-api
info:
  name: WADL API - Detect
  author: 0xrudra,manuelbua
  severity: info
  description: WADL API was detected.
  tags: exposure,api
http:
  - method: GET
    path:
      - "{{BaseURL}}/application.wadl"
      - "{{BaseURL}}/application.wadl?detail=true"
      - "{{BaseURL}}/api/application.wadl"
      - "{{BaseURL}}/api/v1/application.wadl"
      - "{{BaseURL}}/api/v2/application.wadl"
    redirects: true
    max-redirects: 10
    stop-at-first-match: true
    extractors:
      - type: regex
        name: wadl_get
        part: body
        group: 0
        internal: true
        regex:
          - '(?i)(This is simplified WADL|jersey\.java\.net|wadl\.dev\.java\.net)'
      - type: dsl
        dsl:
          - 'len(wadl_get) > 0 ? to_value_group("api.spec.wadl", wadl_get) : ""'
  - method: OPTIONS
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/api/v1"
      - "{{BaseURL}}/api/v2"
    redirects: true
    max-redirects: 10
    stop-at-first-match: true
    extractors:
      - type: regex
        name: wadl_options
        part: body
        group: 0
        internal: true
        regex:
          - '(?i)(This is simplified WADL|jersey\.java\.net|wadl\.dev\.java\.net)'
      - type: dsl
        dsl:
          - 'len(wadl_options) > 0 ? to_value_group("api.spec.wadl", wadl_options) : ""'
