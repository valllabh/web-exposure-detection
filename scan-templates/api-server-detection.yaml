id: api-server-detection
info:
  name: API Server Detection
  author: Vallabh
  severity: info
  description: Detects API servers by checking content-type headers for JSON/XML responses
  tags: api,json,xml,rest,detection

http:
  - method: GET
    path:
      - "{{BaseURL}}"
    extractors:
      - type: kval
        name: content_type
        part: header
        internal: true
        kval:
          - content_type
      - type: dsl
        dsl:
          - 'contains(tolower(content_type), "application/json") ? to_value_group("api.server.json", "json") : ""'
      - type: dsl
        dsl:
          - 'contains(tolower(content_type), "application/xml") ? to_value_group("api.server.xml", "xml") : ""'
