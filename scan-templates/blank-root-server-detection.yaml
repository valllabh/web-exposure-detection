id: blank-root-server-detection
info:
  name: HTTP Server with Blank Root Detection
  author: Vallabh
  severity: info
  description: |
    Detects HTTP servers serving blank, default, or minimal content pages
  tags: blank-root,server-default
http:
  - method: GET
    path:
      - "{{BaseURL}}"
    redirects: true
    max-redirects: 3
    matchers-condition: or
    matchers:
      # Detect server default pages
      - type: word
        part: body
        words:
          - "Apache2 Default Page"
          - "Welcome to nginx"
          - "IIS Windows Server"
          - "It works!"
          - "Test Page"
          - "Default Web Site Page"
          - "Apache HTTP Server Test Page"
          - "This page is used to test the proper operation of the Apache HTTP server"
          - "If you can see this page, then the people who own this host have just installed the web server software successfully"
          - "Apache2 Ubuntu Default Page"
          - "nginx default page"
        condition: or
      # Detect minimal/empty body content with very few elements
      - type: regex
        part: body
        regex:
          - "(?i)<body[^>]*>\\s*</body>"
          - "(?i)<body[^>]*>\\s*(&nbsp;|\\s)*\\s*</body>"
          - "(?i)<body[^>]*>\\s*<(br|p|div)[^>]*>\\s*</(br|p|div)>\\s*</body>"
        condition: or
      # Detect pages with minimal content (very short body, few links/elements)
      - type: dsl
        dsl:
          - 'len(body) < 500 && !contains(tolower(body), "login") && !contains(tolower(body), "signin") && !contains(tolower(body), "form") && !contains(tolower(body), "script") && !contains(tolower(body), "stylesheet")'
        condition: and
