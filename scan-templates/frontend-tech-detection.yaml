id: frontend-tech-detection
info:
  name: Frontend Technology, Authentication & Webapp Type Detection
  author: Vallabh
  severity: info
  description: |
    Detects frontend JavaScript frameworks, authentication mechanisms, and webapp types on web applications.
    Frameworks: React.js, Angular, Vue.js, Svelte, Ember.js, Preact, SolidJS, Backbone.js, Alpine.js, Lit,
    Marko, Mithril, Inferno, Hyperapp, Dojo Toolkit, Knockout.js, Meteor, Next.js, Nuxt.js, Gatsby,
    Remix, Astro, Qwik, Fresh.
    Authentication: Traditional forms, SSO, social login, MFA, passwordless, registration, password recovery.
    Webapp Types: E-commerce, Payment Processing, Admin Panel, SaaS Dashboard, Customer Portal, Developer Portal,
    Marketing Site, Blog, Corporate Website, Documentation, Landing Page.
  tags: frontend,spa,js,auth,login,authentication,detection,webapp,classification
headless:
  - steps:
      - action: navigate
        args:
          url: "{{BaseURL}}"
      - action: waitload
      - action: waitstable
    extractors:
      # Extractor for React.js
      - type: regex
        name: react
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(data-reactroot|__REACT_DEVTOOLS_GLOBAL_HOOK__|react-dom\\/)"
      # Extractor for Angular
      - type: regex
        name: angular
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(ng-app|ng-controller|ng-model|ng-version=|angular\\.[a-z])"
      # Extractor for Vue.js
      - type: regex
        name: vuejs
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(window\\.__VUE__|vue\\.[a-z]|data-v-)"
      # Extractor for Svelte
      - type: regex
        name: svelte
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(svelte-[a-z0-9]+|__SVELTEKIT_DEV__|SvelteKit)"
      # Extractor for Ember.js
      - type: regex
        name: ember
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(Ember\\.ENV|Ember\\.Application|data-ember-extension)"
      # Extractor for Preact
      - type: regex
        name: preact
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(preactRender|preact\\/|__PREACT_DEVTOOLS__)"
      # Extractor for SolidJS
      - type: regex
        name: solidjs
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(window\\.__SOLID_DEVTOOLS_HOOK__|solid-js/|SolidRoot)"
      # Extractor for Backbone.js
      - type: regex
        name: backbone
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(Backbone.(Model|View|Router|Collection))"
      # Extractor for Alpine.js
      - type: regex
        name: alpine
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(<[^>]+(x-data|x-init|x-bind|x-on|x-model)[^>]*>|Alpine\\.start)"
      # Extractor for Lit
      - type: regex
        name: lit
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(lit-html\\/|lit-element\\/|LitElement\\.prototype)"
      # Extractor for Marko
      - type: regex
        name: marko
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(\\$marko|\\$_marko|marko-components|marko\\.runtime)"
      # Extractor for Mithril
      - type: regex
        name: mithril
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(m\\.route\\(|m\\.render\\(|m\\.mount\\()"
      # Extractor for Inferno
      - type: regex
        name: inferno
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(Inferno\\.createElement|Inferno\\.render)"
      # Extractor for Hyperapp
      - type: regex
        name: hyperapp
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(hyperapp\\.app|h\\.app\\()"
      # Extractor for Dojo Toolkit
      - type: regex
        name: dojo
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(dojo\\.require\\(|dojo\\.addOnLoad\\(|dojo\\.version)"
      # Extractor for Knockout.js
      - type: regex
        name: knockout
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(ko\\.applyBindings\\(|ko\\.observable\\()"
      # Extractor for Meteor
      - type: regex
        name: meteor
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(__meteor_runtime_config__|Meteor\\.is(Client|Server))"
      # Extractor for Next.js
      - type: regex
        name: nextjs
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(__NEXT_DATA__|next\\/static\\/chunks\\/|window\\.__NEXT_PRELOAD_READY__)"
      # Extractor for Nuxt.js
      - type: regex
        name: nuxtjs
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(window\\.__NUXT__|nuxt\\.config|nuxtState)"
      # Extractor for Gatsby
      - type: regex
        name: gatsby
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(window\\.___gatsby|gatsby-config\\.js|gatsby-browser\\.js)"
      # Extractor for Remix
      - type: regex
        name: remix
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(__remixContext|window\\.__REMIX_CONTEXT__)"
      # Extractor for Astro
      - type: regex
        name: astro
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(Astro\\.fetchContent|astro\\/client|astro:load)"
      # Extractor for Qwik
      - type: regex
        name: qwik
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(qwik\\.devtools|qwik\\.hydrate|QwikCity)"
      # Extractor for Fresh
      - type: regex
        name: fresh
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(window\\.__FRESH_DATA__|FreshRuntime|window\\.__FRESH_MANIFEST__)"

      # Authentication Extractors
      # Traditional authentication forms
      - type: regex
        part: body
        name: basic_auth
        internal: true
        regex:
          - "(?i)<form[^>]*?(login|signin|sign-in|log-in|authenticate)"
          - "(?i)<input[^>]+type=[\"']password[\"']"
          - "(?i)<input[^>]+name=[\"']+(username|user-name|email|user|login|password|pwd)[\"']"
        group: 0

      # SSO and Enterprise Authentication - Generic SAML/SSO
      - type: regex
        part: body
        name: saml_sso
        internal: true
        regex:
          - "(?i)(saml|sso|single.sign.on)"
          - "(?i)href=[\"'][^\"']*saml[^\"']*[\"']"
          - "(?i)href=[\"'][^\"']*sso[^\"']*[\"']"
          - "(?i)action=[\"'][^\"']*(saml|sso)[^\"']*[\"']"
        group: 0

      # SSO and Enterprise Authentication - Microsoft/Azure AD
      - type: regex
        part: body
        name: microsoft_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on).{0,20}(microsoft|azure)"
          - "(?i)(microsoft|azure).{0,20}(sign|log).{0,10}(in|on)"
          - "(?i)(azure.ad|azuread|microsoft.365|office.365)"
          - "(?i)href=[\"'][^\"']*login\\.microsoftonline\\.com[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*(microsoft|azure).*(login|signin|auth|sso)[^\"']*[\"']"
        group: 0

      # SSO and Enterprise Authentication - Okta
      - type: regex
        part: body
        name: okta_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on).{0,20}okta"
          - "(?i)okta.{0,20}(sign|log).{0,10}(in|on)"
          - "(?i)href=[\"'][^\"']*okta\\.com[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*okta.*(login|signin|auth|sso)[^\"']*[\"']"
        group: 0

      # SSO and Enterprise Authentication - Auth0
      - type: regex
        part: body
        name: auth0_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on).{0,20}auth0"
          - "(?i)auth0.{0,20}(sign|log).{0,10}(in|on)"
          - "(?i)href=[\"'][^\"']*auth0\\.com[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*auth0.*(login|signin|auth|sso)[^\"']*[\"']"
        group: 0

      # SSO and Enterprise Authentication - OneLogin
      - type: regex
        part: body
        name: onelogin_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on).{0,20}onelogin"
          - "(?i)onelogin.{0,20}(sign|log).{0,10}(in|on)"
          - "(?i)href=[\"'][^\"']*onelogin\\.com[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*onelogin.*(login|signin|auth|sso)[^\"']*[\"']"
        group: 0

      # SSO and Enterprise Authentication - Keycloak
      - type: regex
        part: body
        name: keycloak_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on).{0,20}keycloak"
          - "(?i)keycloak.{0,20}(sign|log).{0,10}(in|on)"
          - "(?i)href=[\"'][^\"']*keycloak[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*keycloak.*(login|signin|auth|sso)[^\"']*[\"']"
        group: 0

      # SSO and Enterprise Authentication - ADFS
      - type: regex
        part: body
        name: adfs_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on).{0,20}adfs"
          - "(?i)adfs.{0,20}(sign|log).{0,10}(in|on)"
          - "(?i)href=[\"'][^\"']*adfs[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*adfs.*(login|signin|auth|sso)[^\"']*[\"']"
        group: 0

      # Social login providers - Google
      - type: regex
        part: body
        name: google_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on|up).{0,20}(with|using|via).{0,20}google"
          - "(?i)google.{0,20}(sign|log).{0,10}(in|on|up)"
          - "(?i)connect.{0,20}(with|via).{0,20}google"
          - "(?i)authenticate.{0,20}(with|using|via).{0,20}google"
          - "(?i)(class|id)=[\"'][^\"']*google.*(login|signin|auth|sso)[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*(login|signin|auth|sso).*google[^\"']*[\"']"
          - "(?i)href=[\"'][^\"']*accounts\\.google\\.com[^\"']*[\"']"
        group: 0

      # Social login providers - Facebook
      - type: regex
        part: body
        name: facebook_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on|up).{0,20}(with|using|via).{0,20}facebook"
          - "(?i)facebook.{0,20}(sign|log).{0,10}(in|on|up)"
          - "(?i)connect.{0,20}(with|via).{0,20}facebook"
          - "(?i)authenticate.{0,20}(with|using|via).{0,20}facebook"
          - "(?i)(class|id)=[\"'][^\"']*facebook.*(login|signin|auth|sso)[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*(login|signin|auth|sso).*facebook[^\"']*[\"']"
          - "(?i)href=[\"'][^\"']*facebook\\.com/dialog/oauth[^\"']*[\"']"
        group: 0

      # Social login providers - Twitter
      - type: regex
        part: body
        name: twitter_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on|up).{0,20}(with|using|via).{0,20}(twitter|x\\.com)"
          - "(?i)(twitter|x\\.com).{0,20}(sign|log).{0,10}(in|on|up)"
          - "(?i)connect.{0,20}(with|via).{0,20}(twitter|x\\.com)"
          - "(?i)authenticate.{0,20}(with|using|via).{0,20}(twitter|x\\.com)"
          - "(?i)(class|id)=[\"'][^\"']*(twitter|x\\.com).*(login|signin|auth|sso)[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*(login|signin|auth|sso).*(twitter|x\\.com)[^\"']*[\"']"
          - "(?i)href=[\"'][^\"']*(twitter\\.com|x\\.com).*oauth[^\"']*[\"']"
        group: 0

      # Social login providers - LinkedIn
      - type: regex
        part: body
        name: linkedin_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on|up).{0,20}(with|using|via).{0,20}linkedin"
          - "(?i)linkedin.{0,20}(sign|log).{0,10}(in|on|up)"
          - "(?i)connect.{0,20}(with|via).{0,20}linkedin"
          - "(?i)authenticate.{0,20}(with|using|via).{0,20}linkedin"
          - "(?i)(class|id)=[\"'][^\"']*linkedin.*(login|signin|auth|sso)[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*(login|signin|auth|sso).*linkedin[^\"']*[\"']"
          - "(?i)href=[\"'][^\"']*linkedin\\.com/oauth[^\"']*[\"']"
        group: 0

      # Social login providers - GitHub
      - type: regex
        part: body
        name: github_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on|up).{0,20}(with|using|via).{0,20}github"
          - "(?i)github.{0,20}(sign|log).{0,10}(in|on|up)"
          - "(?i)connect.{0,20}(with|via).{0,20}github"
          - "(?i)authenticate.{0,20}(with|using|via).{0,20}github"
          - "(?i)(class|id)=[\"'][^\"']*github.*(login|signin|auth|sso)[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*(login|signin|auth|sso).*github[^\"']*[\"']"
          - "(?i)href=[\"'][^\"']*github\\.com/(login/oauth|oauth)[^\"']*[\"']"
        group: 0

      # Social login providers - Apple
      - type: regex
        part: body
        name: apple_auth
        internal: true
        regex:
          - "(?i)(sign|log).{0,10}(in|on|up).{0,20}(with|using|via).{0,20}apple"
          - "(?i)apple.{0,20}(sign|log).{0,10}(in|on|up)"
          - "(?i)connect.{0,20}(with|via).{0,20}apple"
          - "(?i)authenticate.{0,20}(with|using|via).{0,20}apple"
          - "(?i)(class|id)=[\"'][^\"']*apple.*(login|signin|auth|sso)[^\"']*[\"']"
          - "(?i)(class|id)=[\"'][^\"']*(login|signin|auth|sso).*apple[^\"']*[\"']"
          - "(?i)href=[\"'][^\"']*appleid\\.apple\\.com/auth[^\"']*[\"']"
        group: 0

      # Multi-factor authentication
      - type: regex
        part: body
        name: mfa_auth
        internal: true
        regex:
          - "(?i)(multi.factor|two.factor|2fa|mfa|authenticator)"
          - "(?i)(verification.code|security.code|auth.code)"
          - "(?i)(sms.code|phone.verification|mobile.verification)"
          - "(?i)(totp|time.based|google.authenticator|authy)"
        group: 0

      # Passwordless authentication
      - type: regex
        part: body
        name: passwordless_auth
        internal: true
        regex:
          - "(?i)(passwordless|magic.link|email.link)"
          - "(?i)(fingerprint|biometric|face.id|touch.id)"
          - "(?i)(webauthn|fido|yubikey|security.key)"
        group: 0

      # Registration/signup forms
      - type: regex
        part: body
        name: registration
        internal: true
        regex:
          - "(?i)<form[^>]*?(register|signup|sign-up|create.account)"
          - "(?i)<a[^>]+href=[\"'][^\"']*(register|signup|sign-up|create)[^\"']*[\"']"
          - "(?i)(register|signup|sign.up|create.account|join.now)"
        group: 0

      # Password recovery
      - type: regex
        part: body
        name: password_recovery
        internal: true
        regex:
          - "(?i)(forgot|forgotten|reset).{0,20}password"
          - "(?i)password.{0,20}(forgot|forgotten|reset)"
          - "(?i)<a[^>]+href=[\"'][^\"']*(forgot|reset|recover)[^\"']*[\"']"
        group: 0

      # Blank root status - check directly in body
      - type: dsl
        name: blank_root_status
        internal: true
        dsl:
          - 'contains(body, "Apache2 Default Page")'
          - 'contains(body, "Welcome to nginx")'
          - 'contains(body, "IIS Windows Server")'
          - 'contains(body, "It works!")'
          - 'contains(body, "Test Page")'
          - 'contains(body, "Default Web Site Page")'

      # Backend Framework Detection - CMS Platforms
      - type: regex
        name: wordpress
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(wp-content|wp-includes|wp-admin)"
      - type: regex
        name: drupal
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(Drupal.settings|data-drupal-selector)"
      - type: regex
        name: joomla
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(/media/system/js/|/components/com_|joomla)"
      - type: regex
        name: typo3
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(typo3|fe_typo_user)"

      # Backend Framework Detection - E-commerce Platforms
      - type: regex
        name: shopify
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(cdn.shopify.com|Shopify.designMode|window.checkoutConfig)"
      - type: regex
        name: magento
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(Mage\\.Cookies|/skin/frontend/|adminhtml)"
      - type: regex
        name: woocommerce
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(/wp-content/plugins/woocommerce/|woocommerce)"
      - type: regex
        name: prestashop
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(/modules/prestashop|PrestaShop)"
      - type: regex
        name: bigcommerce
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(bigcommerce\\.com|stencil-utils\\.js)"
      - type: regex
        name: opencart
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(/catalog/view/theme/|OCSESSID)"

      # Backend Framework Detection - Site Builders
      - type: regex
        name: wix
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(static\\.wixstatic\\.com|wix-)"
      - type: regex
        name: squarespace
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(static1\\.squarespace\\.com|squarespace-|sqsp-)"

      # Backend Framework Detection - Backend Frameworks
      - type: regex
        name: laravel
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(laravel_token|laravel_session)"
      - type: regex
        name: django
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(csrfmiddlewaretoken|django)"
      - type: regex
        name: aspnet
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(__VIEWSTATE|__EVENTVALIDATION|ASP\\.NET)"
      - type: regex
        name: express_backend
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(X-Powered-By: Express)"
      - type: regex
        name: jsp
        part: cookie
        group: 1
        internal: true
        regex:
          - "(?i)(JSESSIONID)"
      - type: regex
        name: php
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(X-Powered-By.*PHP|PHPSESSID)"
      - type: regex
        name: spring
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(X-Application-Context)"
      - type: regex
        name: ghost
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(ghost-sdk\\.js|data-ghost)"
      - type: regex
        name: kentico
        part: body
        group: 1
        internal: true
        regex:
          - "(?i)(/CMSPages/|CMSPreferredCulture)"

      # API Server Framework Detection
      - type: regex
        name: fastapi
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(server.*uvicorn|server.*hypercorn)"
      - type: regex
        name: flask
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(X-Powered-By.*Flask|server.*werkzeug)"
      - type: regex
        name: gin
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)X-Gin"
      - type: regex
        name: koa
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)X-Powered-By.*Koa"
      - type: regex
        name: nestjs
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)X-Powered-By.*NestJS"

      # Infrastructure Detection - API Gateway/Proxy/Load Balancer
      - type: regex
        name: kong
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(kong|openresty)"
      - type: regex
        name: envoy
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(envoy|istio)"
      - type: regex
        name: akamai
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(akamai|edgegrid)"
      - type: regex
        name: traefik
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(traefik|traefik-proxy)"
      - type: regex
        name: cloudflare
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(cloudflare|cf-ray)"
      - type: regex
        name: nginx
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(nginx)"
      - type: regex
        name: haproxy
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(haproxy|haproxy-proxy)"
      - type: regex
        name: zuul
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(zuul|zuul-proxy)"
      - type: regex
        name: apigee
        part: header
        group: 1
        internal: true
        regex:
          - "(?i)(apigee|apigee-proxy)"

      # Page title extraction
      - type: regex
        part: body
        name: page_title
        internal: true
        regex:
          - "<title[^>]*>([^<]+)</title>"
        group: 1

      # Page description extraction
      - type: regex
        part: body
        name: page_description
        internal: true
        regex:
          - "(?i)<meta[^>]+name=[\"']description[\"'][^>]+content=[\"']([^\"']+)[\"']"
          - "(?i)<meta[^>]+content=[\"']([^\"']+)[\"'][^>]+name=[\"']description[\"']"
        group: 1

      # DSL extractors - each extractor returns its own finding using to_value_group
      # Frontend frameworks
      - type: dsl
        dsl:
          - 'len(react) > 0 ? to_value_group("frontend.react", react) : ""'
      - type: dsl
        dsl:
          - 'len(angular) > 0 ? to_value_group("frontend.angular", angular) : ""'
      - type: dsl
        dsl:
          - 'len(vuejs) > 0 ? to_value_group("frontend.vuejs", vuejs) : ""'
      - type: dsl
        dsl:
          - 'len(svelte) > 0 ? to_value_group("frontend.svelte", svelte) : ""'
      - type: dsl
        dsl:
          - 'len(ember) > 0 ? to_value_group("frontend.ember", ember) : ""'
      - type: dsl
        dsl:
          - 'len(preact) > 0 ? to_value_group("frontend.preact", preact) : ""'
      - type: dsl
        dsl:
          - 'len(solidjs) > 0 ? to_value_group("frontend.solidjs", solidjs) : ""'
      - type: dsl
        dsl:
          - 'len(backbone) > 0 ? to_value_group("frontend.backbone", backbone) : ""'
      - type: dsl
        dsl:
          - 'len(alpine) > 0 ? to_value_group("frontend.alpine", alpine) : ""'
      - type: dsl
        dsl:
          - 'len(lit) > 0 ? to_value_group("frontend.lit", lit) : ""'
      - type: dsl
        dsl:
          - 'len(marko) > 0 ? to_value_group("frontend.marko", marko) : ""'
      - type: dsl
        dsl:
          - 'len(mithril) > 0 ? to_value_group("frontend.mithril", mithril) : ""'
      - type: dsl
        dsl:
          - 'len(inferno) > 0 ? to_value_group("frontend.inferno", inferno) : ""'
      - type: dsl
        dsl:
          - 'len(hyperapp) > 0 ? to_value_group("frontend.hyperapp", hyperapp) : ""'
      - type: dsl
        dsl:
          - 'len(dojo) > 0 ? to_value_group("frontend.dojo", dojo) : ""'
      - type: dsl
        dsl:
          - 'len(knockout) > 0 ? to_value_group("frontend.knockout", knockout) : ""'
      - type: dsl
        dsl:
          - 'len(meteor) > 0 ? to_value_group("frontend.meteor", meteor) : ""'
      - type: dsl
        dsl:
          - 'len(nextjs) > 0 ? to_value_group("frontend.nextjs", nextjs) : ""'
      - type: dsl
        dsl:
          - 'len(nuxtjs) > 0 ? to_value_group("frontend.nuxtjs", nuxtjs) : ""'
      - type: dsl
        dsl:
          - 'len(gatsby) > 0 ? to_value_group("frontend.gatsby", gatsby) : ""'
      - type: dsl
        dsl:
          - 'len(remix) > 0 ? to_value_group("frontend.remix", remix) : ""'
      - type: dsl
        dsl:
          - 'len(astro) > 0 ? to_value_group("frontend.astro", astro) : ""'
      - type: dsl
        dsl:
          - 'len(qwik) > 0 ? to_value_group("frontend.qwik", qwik) : ""'
      - type: dsl
        dsl:
          - 'len(fresh) > 0 ? to_value_group("frontend.fresh", fresh) : ""'

      # Authentication
      - type: dsl
        dsl:
          - 'len(basic_auth) > 0 ? to_value_group("auth.traditional.basic_auth", basic_auth) : ""'
      - type: dsl
        dsl:
          - 'len(saml_sso) > 0 ? to_value_group("auth.enterprise.saml_sso", saml_sso) : ""'
      - type: dsl
        dsl:
          - 'len(microsoft_auth) > 0 ? to_value_group("auth.enterprise.microsoft", microsoft_auth) : ""'
      - type: dsl
        dsl:
          - 'len(okta_auth) > 0 ? to_value_group("auth.enterprise.okta", okta_auth) : ""'
      - type: dsl
        dsl:
          - 'len(auth0_auth) > 0 ? to_value_group("auth.enterprise.auth0", auth0_auth) : ""'
      - type: dsl
        dsl:
          - 'len(onelogin_auth) > 0 ? to_value_group("auth.enterprise.onelogin", onelogin_auth) : ""'
      - type: dsl
        dsl:
          - 'len(keycloak_auth) > 0 ? to_value_group("auth.enterprise.keycloak", keycloak_auth) : ""'
      - type: dsl
        dsl:
          - 'len(adfs_auth) > 0 ? to_value_group("auth.enterprise.adfs", adfs_auth) : ""'
      - type: dsl
        dsl:
          - 'len(google_auth) > 0 ? to_value_group("auth.social.google", google_auth) : ""'
      - type: dsl
        dsl:
          - 'len(facebook_auth) > 0 ? to_value_group("auth.social.facebook", facebook_auth) : ""'
      - type: dsl
        dsl:
          - 'len(twitter_auth) > 0 ? to_value_group("auth.social.twitter", twitter_auth) : ""'
      - type: dsl
        dsl:
          - 'len(linkedin_auth) > 0 ? to_value_group("auth.social.linkedin", linkedin_auth) : ""'
      - type: dsl
        dsl:
          - 'len(github_auth) > 0 ? to_value_group("auth.social.github", github_auth) : ""'
      - type: dsl
        dsl:
          - 'len(apple_auth) > 0 ? to_value_group("auth.social.apple", apple_auth) : ""'
      - type: dsl
        dsl:
          - 'len(mfa_auth) > 0 ? to_value_group("auth.mfa", mfa_auth) : ""'
      - type: dsl
        dsl:
          - 'len(passwordless_auth) > 0 ? to_value_group("auth.passwordless", passwordless_auth) : ""'
      - type: dsl
        dsl:
          - 'len(registration) > 0 ? to_value_group("auth.traditional.registration", registration) : ""'
      - type: dsl
        dsl:
          - 'len(password_recovery) > 0 ? to_value_group("auth.traditional.password_recovery", password_recovery) : ""'

      # Blank root status
      - type: dsl
        dsl:
          - 'len(blank_root_status) > 0 ? to_value_group("server.blank_root_status", blank_root_status) : ""'

      # Backend frameworks - CMS
      - type: dsl
        dsl:
          - 'len(wordpress) > 0 ? to_value_group("backend.cms.wordpress", wordpress) : ""'
      - type: dsl
        dsl:
          - 'len(drupal) > 0 ? to_value_group("backend.cms.drupal", drupal) : ""'
      - type: dsl
        dsl:
          - 'len(joomla) > 0 ? to_value_group("backend.cms.joomla", joomla) : ""'
      - type: dsl
        dsl:
          - 'len(typo3) > 0 ? to_value_group("backend.cms.typo3", typo3) : ""'
      - type: dsl
        dsl:
          - 'len(ghost) > 0 ? to_value_group("backend.cms.ghost", ghost) : ""'
      - type: dsl
        dsl:
          - 'len(kentico) > 0 ? to_value_group("backend.cms.kentico", kentico) : ""'

      # Backend frameworks - E-commerce
      - type: dsl
        dsl:
          - 'len(shopify) > 0 ? to_value_group("backend.ecommerce.shopify", shopify) : ""'
      - type: dsl
        dsl:
          - 'len(magento) > 0 ? to_value_group("backend.ecommerce.magento", magento) : ""'
      - type: dsl
        dsl:
          - 'len(woocommerce) > 0 ? to_value_group("backend.ecommerce.woocommerce", woocommerce) : ""'
      - type: dsl
        dsl:
          - 'len(prestashop) > 0 ? to_value_group("backend.ecommerce.prestashop", prestashop) : ""'
      - type: dsl
        dsl:
          - 'len(bigcommerce) > 0 ? to_value_group("backend.ecommerce.bigcommerce", bigcommerce) : ""'
      - type: dsl
        dsl:
          - 'len(opencart) > 0 ? to_value_group("backend.ecommerce.opencart", opencart) : ""'

      # Backend frameworks - Site builders
      - type: dsl
        dsl:
          - 'len(wix) > 0 ? to_value_group("backend.sitebuilder.wix", wix) : ""'
      - type: dsl
        dsl:
          - 'len(squarespace) > 0 ? to_value_group("backend.sitebuilder.squarespace", squarespace) : ""'

      # Backend frameworks - Frameworks
      - type: dsl
        dsl:
          - 'len(laravel) > 0 ? to_value_group("backend.framework.laravel", laravel) : ""'
      - type: dsl
        dsl:
          - 'len(django) > 0 ? to_value_group("backend.framework.django", django) : ""'
      - type: dsl
        dsl:
          - 'len(aspnet) > 0 ? to_value_group("backend.framework.aspnet", aspnet) : ""'
      - type: dsl
        dsl:
          - 'len(express_backend) > 0 ? to_value_group("backend.framework.express", express_backend) : ""'
      - type: dsl
        dsl:
          - 'len(jsp) > 0 ? to_value_group("backend.framework.jsp", jsp) : ""'
      - type: dsl
        dsl:
          - 'len(php) > 0 ? to_value_group("backend.framework.php", php) : ""'
      - type: dsl
        dsl:
          - 'len(spring) > 0 ? to_value_group("backend.framework.spring", spring) : ""'

      # API server frameworks
      - type: dsl
        dsl:
          - 'len(fastapi) > 0 ? to_value_group("api.server.fastapi", fastapi) : ""'
      - type: dsl
        dsl:
          - 'len(flask) > 0 ? to_value_group("api.server.flask", flask) : ""'
      - type: dsl
        dsl:
          - 'len(gin) > 0 ? to_value_group("api.server.gin", gin) : ""'
      - type: dsl
        dsl:
          - 'len(koa) > 0 ? to_value_group("api.server.koa", koa) : ""'
      - type: dsl
        dsl:
          - 'len(nestjs) > 0 ? to_value_group("api.server.nestjs", nestjs) : ""'

      # Infrastructure - Gateway/Proxy/CDN
      - type: dsl
        dsl:
          - 'len(kong) > 0 ? to_value_group("gateway.kong", kong) : ""'
      - type: dsl
        dsl:
          - 'len(envoy) > 0 ? to_value_group("gateway.envoy", envoy) : ""'
      - type: dsl
        dsl:
          - 'len(akamai) > 0 ? to_value_group("gateway.akamai", akamai) : ""'
      - type: dsl
        dsl:
          - 'len(traefik) > 0 ? to_value_group("gateway.traefik", traefik) : ""'
      - type: dsl
        dsl:
          - 'len(cloudflare) > 0 ? to_value_group("gateway.cloudflare", cloudflare) : ""'
      - type: dsl
        dsl:
          - 'len(nginx) > 0 ? to_value_group("gateway.nginx", nginx) : ""'
      - type: dsl
        dsl:
          - 'len(haproxy) > 0 ? to_value_group("gateway.haproxy", haproxy) : ""'
      - type: dsl
        dsl:
          - 'len(zuul) > 0 ? to_value_group("gateway.zuul", zuul) : ""'
      - type: dsl
        dsl:
          - 'len(apigee) > 0 ? to_value_group("gateway.apigee", apigee) : ""'

      # Page metadata
      - type: dsl
        dsl:
          - 'len(page_title) > 0 ? to_value_group("page.title", page_title) : ""'
      - type: dsl
        dsl:
          - 'len(page_description) > 0 ? to_value_group("page.description", page_description) : ""'

      # Webapp Type Classification - Regex extractors followed by DSL output
      # E-commerce Detection
      - type: regex
        name: ecommerce_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(add to cart|shopping cart|checkout|buy now|cdn\\.shopify\\.com)"

      # Payment Processing Detection
      - type: regex
        name: payment_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(credit card|cvv|secure checkout|js\\.stripe\\.com|paypal\\.com/sdk)"

      # Admin Panel Detection
      - type: regex
        name: admin_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(admin panel|user management|system settings|audit log|users?\\s*(management|settings)|permissions?\\s*(management|settings)|roles?\\s*(management|settings))"

      # SaaS Dashboard Detection
      - type: regex
        name: saas_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(dashboard|account settings|subscription|billing plan|usage statistics)"

      # Customer Portal Detection
      - type: regex
        name: customer_portal_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(support ticket|my orders|download invoice|customer portal)"

      # Developer Portal Detection
      - type: regex
        name: developer_portal_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(api reference|api documentation|developer guide|code examples|sdk|<code[^>]*>.*</code>)"

      # Marketing Site Detection (includes corporate website patterns)
      - type: regex
        name: marketing_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(sign up now|free trial|request demo|subscribe|utm_source|utm_medium|utm_campaign)"
          - "(?i)(about us|careers|contact us|investors|leadership team)"

      # Blog Detection
      - type: regex
        name: blog_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(published on|blog post|comments|rss feed|(january|february|march|april|may|june|july|august|september|october|november|december)\\s+[0-9]{1,2},\\s+[0-9]{4})"

      # Documentation Detection
      - type: regex
        name: documentation_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(documentation|user guide|help center|knowledge base|faq|step\\s+[0-9]|chapter\\s+[0-9])"

      # Landing Page Detection
      - type: regex
        name: landing_indicators
        part: body
        group: 0
        internal: true
        regex:
          - "(?i)(limited time offer|claim your|exclusive offer|countdown|timer|expires)"

      # Output webapp type findings using DSL
      - type: dsl
        dsl:
          - 'len(ecommerce_indicators) > 0 ? to_value_group("webapp.type.ecommerce", ecommerce_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(payment_indicators) > 0 ? to_value_group("webapp.type.payment_processing", payment_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(admin_indicators) > 0 ? to_value_group("webapp.type.admin_panel", admin_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(saas_indicators) > 0 ? to_value_group("webapp.type.saas_dashboard", saas_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(customer_portal_indicators) > 0 ? to_value_group("webapp.type.customer_portal", customer_portal_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(developer_portal_indicators) > 0 ? to_value_group("webapp.type.developer_portal", developer_portal_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(marketing_indicators) > 0 ? to_value_group("webapp.type.marketing", marketing_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(blog_indicators) > 0 ? to_value_group("webapp.type.blog", blog_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(documentation_indicators) > 0 ? to_value_group("webapp.type.documentation", documentation_indicators) : ""'
      - type: dsl
        dsl:
          - 'len(landing_indicators) > 0 ? to_value_group("webapp.type.landing_page", landing_indicators) : ""'

