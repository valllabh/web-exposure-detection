# CVE Applicability Review

This document reviews each finding category to determine if CVE data should be queried.

## Review Criteria

CVE data IS applicable when:
- ✅ Software product with version releases
- ✅ Self-hosted/installable software
- ✅ Known security vulnerabilities exist
- ✅ Software runs on customer infrastructure

CVE data is NOT applicable when:
- ❌ Cloud service managed by vendor
- ❌ Authentication protocol/method (not a product)
- ❌ Metadata/configuration indicator
- ❌ Pattern/convention (not software)

## Findings Review

### 1. Frontend Frameworks (24 findings) - **APPLICABLE: YES** ✅

**Products:**
- React, Angular, Vue.js, Svelte, Ember, Preact, SolidJS, Backbone, Alpine, Lit
- Marko, Mithril, Inferno, Hyperapp, Dojo, Knockout, Meteor
- Next.js, Nuxt.js, Gatsby, Remix, Astro, Qwik, Fresh

**Rationale:**
- All are installable software libraries/frameworks
- Have version releases with security patches
- Run on customer infrastructure
- Known CVEs exist (e.g., React XSS, Next.js path traversal)
- **Decision: KEEP cve_applicable=true** ✅

---

### 2. Backend CMS Platforms (6 findings) - **APPLICABLE: YES** ✅

**Products:**
- WordPress, Drupal, Joomla, TYPO3, Ghost, Kentico

**Rationale:**
- Self-hosted content management systems
- High-profile targets with many CVEs
- Require regular security updates
- **Decision: KEEP cve_applicable=true** ✅

---

### 3. E-commerce Platforms (6 findings) - **MIXED** ⚠️

**Currently marked as applicable:**
- Shopify - **SHOULD BE FALSE** ❌ (Cloud SaaS, vendor-managed)
- Magento - **KEEP TRUE** ✅ (Self-hosted, Adobe Commerce)
- WooCommerce - **KEEP TRUE** ✅ (WordPress plugin, self-hosted)
- PrestaShop - **KEEP TRUE** ✅ (Self-hosted)
- BigCommerce - **SHOULD BE FALSE** ❌ (Cloud SaaS, vendor-managed)
- OpenCart - **KEEP TRUE** ✅ (Self-hosted)

**Rationale:**
- Shopify/BigCommerce: Fully managed SaaS, customers don't run the software
- Magento/WooCommerce/PrestaShop/OpenCart: Self-hosted, customer responsibility
- **Decision: REVIEW NEEDED** ⚠️

---

### 4. Site Builders (2 findings) - **APPLICABLE: NO** ❌

**Products:**
- Wix - **SHOULD BE FALSE** ❌
- Squarespace - **SHOULD BE FALSE** ❌

**Rationale:**
- Fully managed cloud platforms
- Customers never host/install software
- No customer responsibility for vulnerabilities
- **Decision: CHANGE to cve_applicable=false** ❌

---

### 5. Backend Frameworks (8 findings) - **APPLICABLE: YES** ✅

**Products:**
- Laravel, Django, ASP.NET, Ruby on Rails, Express.js, JSP, PHP, Spring Boot

**Rationale:**
- All are software frameworks/runtimes
- Installed and run by customers
- Known CVEs exist
- **Decision: KEEP cve_applicable=true** ✅

---

### 6. API Specifications (5 findings) - **MIXED** ⚠️

**Currently marked as applicable:**
- OpenAPI Spec - **SHOULD BE FALSE** ❌ (Documentation format, not software)
- Swagger Spec - **SHOULD BE FALSE** ❌ (Documentation format, not software)
- Postman Collection - **REVIEW** ⚠️ (Could be Postman app CVEs)
- WADL Spec - **SHOULD BE FALSE** ❌ (XML schema, not software)
- WSDL Spec - **SHOULD BE FALSE** ❌ (XML schema, not software)

**Rationale:**
- OpenAPI/Swagger: JSON/YAML specs, not executable software
- WADL/WSDL: XML schemas, not software products
- Postman: Collection format, but Postman app has CVEs
- **Decision: REVIEW NEEDED** ⚠️

---

### 7. API Servers (7 findings) - **MIXED** ⚠️

**Currently marked as applicable:**
- JSON API - **SHOULD BE FALSE** ❌ (Content type, not a product)
- XML API - **SHOULD BE FALSE** ❌ (Content type, not a product)
- FastAPI - **KEEP TRUE** ✅ (Python framework)
- Flask - **KEEP TRUE** ✅ (Python framework)
- Gin - **KEEP TRUE** ✅ (Go framework)
- Koa - **KEEP TRUE** ✅ (Node.js framework)
- NestJS - **KEEP TRUE** ✅ (Node.js framework)

**Rationale:**
- JSON/XML API: These detect content types, not specific products
- FastAPI/Flask/Gin/Koa/NestJS: Actual frameworks with CVEs
- **Decision: REVIEW NEEDED** ⚠️

---

### 8. AI Services (9 findings) - **MIXED** ⚠️

**Currently marked as applicable:**
- MCP Server - **KEEP TRUE** ✅ (Self-hosted protocol server)
- OpenAI API - **SHOULD BE FALSE** ❌ (Cloud service endpoint)
- Ollama - **KEEP TRUE** ✅ (Self-hosted LLM runner)
- Anthropic API - **SHOULD BE FALSE** ❌ (Cloud service endpoint)
- Pinecone - **SHOULD BE FALSE** ❌ (Cloud vector DB)
- Weaviate - **KEEP TRUE** ✅ (Self-hosted vector DB)
- Qdrant - **KEEP TRUE** ✅ (Self-hosted vector DB)
- Milvus - **KEEP TRUE** ✅ (Self-hosted vector DB)
- ChromaDB - **KEEP TRUE** ✅ (Self-hosted embedding DB)

**Rationale:**
- OpenAI/Anthropic/Pinecone: Cloud APIs, vendor-managed
- Ollama/Weaviate/Qdrant/Milvus/ChromaDB: Self-hosted software
- **Decision: REVIEW NEEDED** ⚠️

---

### 9. Gateways/Proxies (9 findings) - **MIXED** ⚠️

**Currently marked as applicable:**
- Nginx - **KEEP TRUE** ✅ (Self-hosted web server)
- Kong - **KEEP TRUE** ✅ (Self-hosted API gateway)
- Envoy - **KEEP TRUE** ✅ (Self-hosted proxy)
- Traefik - **KEEP TRUE** ✅ (Self-hosted load balancer)
- Cloudflare - **SHOULD BE FALSE** ❌ (Cloud CDN service)
- Akamai - **SHOULD BE FALSE** ❌ (Cloud CDN service)
- HAProxy - **KEEP TRUE** ✅ (Self-hosted load balancer)
- Zuul - **KEEP TRUE** ✅ (Self-hosted gateway)
- Apigee - **SHOULD BE FALSE** ❌ (Cloud API management)

**Rationale:**
- Nginx/Kong/Envoy/Traefik/HAProxy/Zuul: Self-hosted infrastructure
- Cloudflare/Akamai/Apigee: Managed cloud services
- **Decision: REVIEW NEEDED** ⚠️

---

### 10. Authentication (18 findings) - **APPLICABLE: NO** ❌

**Products:**
- All auth.* findings (traditional, enterprise, social, MFA, passwordless)

**Rationale:**
- These detect authentication methods/protocols, not products
- Keycloak, Okta, Auth0, etc. CVEs apply to their self-hosted instances
- However, we're detecting the authentication METHOD, not the product version
- **Decision: KEEP cve_applicable=false** ✅ (Already set)

**Exception consideration:**
- If we could detect specific versions (e.g., "Keycloak 20.0.1"), then CVEs would apply
- Current detection only identifies auth METHOD, not product/version
- **Keep as false for now**

---

### 11. Metadata (3 findings) - **APPLICABLE: NO** ❌

**Findings:**
- page.title, page.description, server.blank_root_status, api.domain_pattern

**Rationale:**
- Not software products
- Configuration/metadata indicators
- **Decision: KEEP cve_applicable=false** ✅ (Already set)

---

## Summary of Recommended Changes

### Change to `cve_applicable: false` (12 findings)

**E-commerce (2):**
- backend.ecommerce.shopify
- backend.ecommerce.bigcommerce

**Site Builders (2):**
- backend.sitebuilder.wix
- backend.sitebuilder.squarespace

**API Specifications (4):**
- api.spec.openapi
- api.spec.swagger
- api.spec.wadl
- api.spec.wsdl

**API Servers (2):**
- api.server.json
- api.server.xml

**AI Services (2):**
- api.ai.openai_endpoint
- api.ai.anthropic_endpoint
- api.ai.vector_db.pinecone (managed cloud)

**Gateways (3):**
- gateway.cloudflare
- gateway.akamai
- gateway.apigee

### Uncertain / Need Discussion (1 finding)

**API Specifications:**
- api.spec.postman - Could track Postman app CVEs, but collection format itself has no CVEs

---

## Final Count After Review

- **Currently marked TRUE:** 76 findings
- **Should change to FALSE:** 12-13 findings
- **Final TRUE count:** ~63-64 findings
- **Final FALSE count:** ~34-35 findings

## Implementation

Run this script to apply recommendations:
```bash
python3 scripts/update-findings-cve/apply-cve-applicability-review.py
```
