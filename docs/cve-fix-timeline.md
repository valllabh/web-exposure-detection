# CVE Fix Timeline Data

## Available Data from vulnx

When querying CVEs through vulnx, we get timeline and fix information:

### Timeline Fields

| Field | Description | Example |
|-------|-------------|---------|
| `age_in_days` | Days since CVE was created | `887` (2.4 years) |
| `cve_created_at` | When CVE was published | `2023-02-14T18:15:13Z` |
| `cve_updated_at` | Last update to CVE record | `2025-10-22T15:53:29Z` |
| `vuln_status` | Current vulnerability status | `modified`, `unconfirmed`, `fixed` |

### Fix Information

| Field | Description | Example |
|-------|-------------|---------|
| `remediation` | Fix instructions | `Upgrade to version 3.0.0 or later` |
| `citations` | Links to patches, advisories | GitHub commits, security advisories |
| `citations[].added_at` | When fix was added | `2023-02-15T10:00:00Z` |

### Risk Scoring

| Field | Description | Example |
|-------|-------------|---------|
| `cvss_score` | CVSS v3.1 score | `7.1` |
| `cvss_metrics` | CVSS vector string | `CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L` |
| `epss_score` | Exploit probability (0-1) | `0.00094` (0.094%) |
| `epss_percentile` | EPSS percentile rank | `0.27135` (27.1%) |
| `severity` | Severity level | `critical`, `high`, `medium`, `low` |

### Weakness Information

| Field | Description | Example |
|-------|-------------|---------|
| `cwe` | CWE IDs list | `["CWE-200"]` |
| `weaknesses` | Detailed weakness info | `[{"cwe_id": "CWE-200", "cwe_name": "..."}]` |

## Example: React Critical CVE Timeline

```
CVE-2025-54594:
  Age: 77 days (recent)
  Status: unconfirmed
  Severity: critical
  Fix: Apply remediation commit

CVE-2023-25933:
  Age: 887 days (2.4 years old)
  Status: modified
  Severity: critical
  Fix: Apply commit e6ed9c1... or update to latest

CVE-2022-36010:
  Age: 1163 days (3.2 years old)
  Status: modified
  Severity: critical
  Fix: Upgrade to version 3.0.0 or set allowFunctionEvaluation=false

CVE-2019-12164:
  Age: 2282 days (6.3 years old)
  Status: modified
  Severity: critical
  Fix: Update to v0.57.8_mobile_ui or later

CVE-2018-6342:
  Age: 2486 days (6.8 years old)
  Status: modified
  Severity: critical
  Fix: Update to 1.0.4, 2.0.2, 3.1.2, 4.2.2, or 5.0.2+
```

## Proposed Enhancements

### 1. Add Fix Timeline Stats to findings.json

```json
{
  "frontend.react": {
    "security": {
      "cve_applicable": true,
      "cve": {
        "search_key": "react",
        "stats": {
          "critical": 6,
          "high": 18,
          "medium": 26,
          "low": 2,
          "total": 64,
          "kev": 0
        },
        "timeline": {
          "avg_age_days": 1200,
          "oldest_cve_days": 2486,
          "newest_cve_days": 77,
          "unfixed_count": 5,
          "with_fix_count": 59
        },
        "updated": "2025-10-23T12:15:46Z"
      }
    }
  }
}
```

### 2. Add EPSS (Exploit Prediction) Stats

```json
{
  "frontend.react": {
    "security": {
      "cve": {
        "stats": { ... },
        "epss": {
          "high_risk_count": 12,
          "avg_score": 0.15,
          "max_score": 0.89,
          "above_threshold_count": 8
        }
      }
    }
  }
}
```

### 3. Add Remediation Summary

```json
{
  "frontend.react": {
    "security": {
      "cve": {
        "stats": { ... },
        "remediation": {
          "has_patches": true,
          "upgrade_required": true,
          "latest_safe_version": "18.2.0",
          "workarounds_available": 5
        }
      }
    }
  }
}
```

## Implementation Options

### Option 1: Basic Timeline (Lightweight)
Add just age statistics to existing CVE stats:
- Average CVE age
- Oldest/newest CVE
- Quick to implement (1-2 additional API calls)

### Option 2: Enhanced Timeline + EPSS (Recommended)
Add timeline + exploit prediction:
- Timeline stats
- EPSS scores for prioritization
- Better risk assessment
- Moderate complexity (3-4 additional API calls)

### Option 3: Full Intelligence (Advanced)
Complete CVE intelligence:
- Timeline stats
- EPSS scores
- Remediation info
- Fix availability
- Patch links
- Most comprehensive (5-10 additional API calls)

## Rate Limit Considerations

Current: ~6 queries per finding for CVE stats
- 1 for total count
- 4 for severity breakdown
- 1 for KEV count

Enhanced options:
- Option 1: +2 queries = 8 total
- Option 2: +4 queries = 10 total
- Option 3: +10 queries = 16 total

For 59 findings:
- Current: ~354 API calls
- Option 1: ~472 calls (+33%)
- Option 2: ~590 calls (+67%)
- Option 3: ~944 calls (+167%)

## Recommendation

**Implement Option 2 (Enhanced Timeline + EPSS)**

Rationale:
1. EPSS provides actionable exploit probability
2. Timeline shows patch urgency
3. Reasonable API call increase
4. Aligns with industry best practices (CISA recommends EPSS)

## Sample Query to Get Timeline Data

```bash
# Get full CVE details with timeline
vulnx search "react && severity:critical" --limit 10 --json

# Fields to extract:
- age_in_days
- vuln_status
- remediation
- epss_score
- epss_percentile
- citations (for patch links)
```

## Next Steps

1. Update `update-cve-stats.py` to collect timeline data
2. Update `findings_types.go` to add Timeline/EPSS structs
3. Test with a few findings
4. Document in README
5. Run full update
