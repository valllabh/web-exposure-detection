<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.ReportMetadata.Title}}</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'montserrat': ['Montserrat', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        @page {
            size: A4;
            margin: 0.3in;
        }
        @media print {
            body {
                margin: 0;
                padding: 0;
                background: white !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            .no-print { display: none; }
            thead {
                display: table-header-group;
            }
            tr {
                page-break-inside: avoid;
            }
        }
        * {
            -webkit-print-color-adjust: exact;
            color-adjust: exact;
        }
    </style>
</head>
<body class="font-montserrat bg-white text-gray-700 text-sm leading-snug">
    <div class="max-w-[210mm] mx-auto bg-white p-2.5">

        <!-- Header -->
        <header class="flex justify-between items-center mb-4">
            <div class="flex items-center gap-5">
                <div class="h-9">
                    <img src="./assets/qualys-logo.svg" alt="Qualys Logo" class="h-9 w-auto">
                </div>
                <h1 class="text-[22px] font-bold text-gray-700 m-0">TotalAppSec External Application Discovery</h1>
            </div>
        </header>

        <!-- Scan Info -->
        <div class="bg-white border border-gray-200 rounded-xl p-4 my-5">
            {{if .Summary.DomainMetrics}}
            <div class="flex flex-col gap-2">
                <div class="flex items-center gap-3 flex-wrap">
                    <div class="text-sm text-gray-600">
                        <span class="font-semibold">For</span> {{.ReportMetadata.TargetDomain}}
                    </div>
                    <div class="text-sm text-gray-600">
                        <span class="text-gray-300">|</span>
                        {{.ReportMetadata.Date}}
                    </div>
                </div>
                <div class="flex items-center gap-3 flex-wrap">
                    <div class="flex items-center gap-1.5 text-sm text-gray-600">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                        </svg>
                        <span class="font-semibold">{{.Summary.DomainMetrics.InternetExposed}}</span> Publicly Accessible
                    </div>
                    <div class="text-sm text-gray-600">
                        <span class="font-semibold">{{.Summary.DomainMetrics.NotReachable}}</span> Internal
                    </div>
                    <div class="text-sm text-gray-600">
                        <span class="font-semibold">{{.Summary.DomainMetrics.TotalDiscovered}}</span> Total Discovered
                    </div>
                </div>
            </div>
            {{end}}
        </div>

        <!-- Application Exposure -->
        {{if or (gt .Summary.APIsFound 0) (gt .Summary.APISpecificationsFound 0) (gt .Summary.AIAssetsFound 0) (gt .Summary.WebAppsFound 0)}}
        <div class="bg-white border border-[#e7eaed] rounded-[20px] p-5">
            <h2 class="text-xl font-medium text-[#505964] mb-5">Application Exposure</h2>
            <div class="grid grid-cols-4 gap-4">
                <div class="flex flex-col justify-center px-4 py-4 rounded-[20px] border border-[#ecf2ff]" style="background: linear-gradient(148.39deg, rgba(255,255,255,0.3) -34.39%, rgba(217,228,255,0.3) 102.8%);">
                    <p class="text-xs font-medium text-[#364750] mb-2">API Servers</p>
                    <p class="text-[32px] font-bold text-[#364750] leading-none">{{.Summary.APIsFound}}</p>
                </div>
                <div class="flex flex-col justify-center px-4 py-4 rounded-[20px] border border-[#ecf2ff]" style="background: linear-gradient(148.39deg, rgba(255,255,255,0.3) -34.39%, rgba(217,228,255,0.3) 102.8%);">
                    <p class="text-xs font-medium text-[#364750] mb-2">API Specifications</p>
                    <p class="text-[32px] font-bold text-[#364750] leading-none">{{.Summary.APISpecificationsFound}}</p>
                </div>
                <div class="flex flex-col justify-center px-4 py-4 rounded-[20px] border border-[#ecf2ff]" style="background: linear-gradient(148.39deg, rgba(255,255,255,0.3) -34.39%, rgba(217,228,255,0.3) 102.8%);">
                    <p class="text-xs font-medium text-[#364750] mb-2">AI Apps</p>
                    <p class="text-[32px] font-bold text-[#364750] leading-none">{{.Summary.AIAssetsFound}}</p>
                </div>
                <div class="flex flex-col justify-center px-4 py-4 rounded-[20px] border border-[#ecf2ff]" style="background: linear-gradient(148.39deg, rgba(255,255,255,0.3) -34.39%, rgba(217,228,255,0.3) 102.8%);">
                    <p class="text-xs font-medium text-[#364750] mb-2">Web Apps</p>
                    <p class="text-[32px] font-bold text-[#364750] leading-none">{{.Summary.WebAppsFound}}</p>
                </div>
            </div>
        </div>
        {{end}}

        <!-- Technology Exposure -->
        {{if and .Technologies (gt .Technologies.Count 0)}}
        <div class="bg-white p-5 my-7 rounded-[20px] border border-gray-200">
            <h2 class="text-[#505964] text-xl mb-5 font-medium">Technology Exposure</h2>
            <div class="grid grid-cols-5 gap-4 mt-4">
                {{range $index, $tech := .Technologies.Technologies}}
                {{if lt $index 4}}
                <div class="flex flex-col items-center p-3 bg-white border border-gray-300 rounded-xl">
                    <img src="./assets/{{$tech.Icon}}" alt="{{$tech.DisplayName}}" class="h-6" onerror="this.style.display='none'">
                    <span class="mt-2 text-[10px] font-medium text-gray-600 text-center capitalize">{{$tech.DisplayName}}</span>
                    <span class="mt-1 text-[9px] font-semibold text-blue-500 bg-blue-50 px-2 py-0.5 rounded-lg">{{$tech.Count}}</span>
                </div>
                {{end}}
                {{end}}
                {{if gt .Technologies.Count 4}}
                <div class="flex flex-col items-center justify-center p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl">
                    <span class="text-[28px] font-bold text-white mb-1">{{subtract .Technologies.Count 4}}+</span>
                    <span class="text-[10px] font-semibold text-white">Additional</span>
                </div>
                {{end}}
            </div>
        </div>
        {{end}}

        <!-- Marketing Section -->
        <div class="bg-[#EDF3F9] p-6 rounded-xl my-7 flex items-center justify-between">
            <div class="flex-1">
                <h3 class="text-lg font-bold text-gray-700 mb-3 leading-tight">Attackers can see your {{.Summary.TotalApps}} applications and the technology powering them.</h3>
                <p class="text-[15px] mb-4 text-gray-600 leading-snug">Their attack plan is already in motion. Secure your APIs and Web Apps with Qualys TotalAppSec.</p>
                <a href="https://www.qualys.com/forms/totalappsec/" class="inline-block bg-blue-500 text-white px-6 py-3 rounded-full text-[13px] font-bold no-underline hover:bg-blue-600 transition">Try Qualys TotalAppSec</a>
            </div>
            <div class="ml-8">
                <div class="w-[170px] h-[170px] flex items-center justify-center p-2">
                    <img src="./assets/qr-code.svg" alt="QR Code" class="w-full h-full">
                </div>
            </div>
        </div>

        <!-- API Endpoints -->
        {{if .APIsFound}}
        <div class="my-7">
            <h2 class="text-gray-800 text-2xl mb-5 font-bold">API Endpoints Discovered</h2>

            <div class="bg-white border border-gray-200 rounded-lg p-3 mb-4 flex flex-wrap gap-5 items-center text-[11px]">
                <div class="flex items-center gap-2">
                    <span class="font-semibold text-gray-800">Asset Criticality Score:</span>
                    <div class="flex items-center gap-2">
                        <span class="text-gray-600">Highest</span>
                        <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#a0302e] text-[#a0302e] bg-white">5</span>
                        <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#d97706] text-[#d97706] bg-white">4</span>
                        <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#ea580c] text-[#ea580c] bg-white">3</span>
                        <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#84cc16] text-[#84cc16] bg-white">2</span>
                        <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#10b981] text-[#10b981] bg-white">1</span>
                        <span class="text-gray-600">Lowest</span>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <span class="font-semibold text-gray-800">API Status:</span>
                    <div class="flex items-center gap-3">
                        <div class="flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                            <span>Confirmed</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="w-2 h-2 rounded-full bg-yellow-500"></span>
                            <span>Potential</span>
                        </div>
                    </div>
                </div>
            </div>

            <table class="w-full border-collapse bg-white border border-gray-300 rounded-xl overflow-hidden">
                <thead>
                    <tr class="bg-gray-50">
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Application</th>
                        <th class="text-center p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300 w-20">Criticality</th>
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Findings</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .APIsFound}}
                    <tr class="even:bg-gray-50">
                        <td class="p-3 border-b border-gray-300 align-top text-[13px]">
                            <div class="flex items-start gap-2">
                                {{if eq .Discovered "Confirmed API Endpoint"}}
                                <span class="w-2 h-2 rounded-full bg-green-500 mt-1.5"></span>
                                {{else}}
                                <span class="w-2 h-2 rounded-full bg-yellow-500 mt-1.5"></span>
                                {{end}}
                                <a href="https://{{.Domain}}" target="_blank" class="font-bold text-gray-700 hover:text-blue-600 no-underline">{{.Domain}}</a>
                            </div>
                        </td>
                        <td class="p-3 border-b border-gray-300 text-center align-top">
                            {{if .Criticality}}
                            <span class="inline-flex items-center justify-center w-8 h-8 rounded-md text-sm font-bold border-2 bg-white criticality-score-{{.Criticality.Score}}" style="border-color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}}; color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}};">{{.Criticality.Score}}</span>
                            {{end}}
                        </td>
                        <td class="p-3 border-b border-gray-300 align-top w-2/5">
                            <ul class="list-disc pl-5 m-0">
                                {{if and (eq (len .FindingItems) 1) (eq (index .FindingItems 0).DisplayName "Routing Server")}}
                                <li class="py-0.5 text-xs text-gray-600">Basic web service detected</li>
                                {{else}}
                                {{range .FindingItems}}
                                {{if and (eq .DisplayAs "link") .Values}}
                                    {{$name := .DisplayName}}
                                    {{range .Values}}
                                    <li class="py-0.5 text-xs"><a href="{{.}}" target="_blank" class="text-blue-600 no-underline font-medium hover:text-blue-800 hover:underline">{{$name}}</a></li>
                                    {{end}}
                                {{else}}
                                <li class="py-0.5 text-xs text-gray-600">{{.DisplayName}}</li>
                                {{end}}
                                {{end}}
                                {{end}}
                            </ul>
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}

        <!-- API Specifications -->
        {{if .APISpecsFound}}
        <div class="my-7">
            <h2 class="text-gray-800 text-2xl mb-5 font-bold">API Specifications Discovered</h2>
            <table class="w-full border-collapse bg-white border border-gray-300 rounded-xl overflow-hidden">
                <thead>
                    <tr class="bg-gray-50">
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Application</th>
                        <th class="text-center p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300 w-20">Criticality</th>
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Findings</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .APISpecsFound}}
                    <tr class="even:bg-gray-50">
                        <td class="p-3 border-b border-gray-300 align-top text-[13px]">
                            <a href="https://{{.Domain}}" target="_blank" class="font-bold text-gray-700 hover:text-blue-600 no-underline">{{.Domain}}</a>
                        </td>
                        <td class="p-3 border-b border-gray-300 text-center align-top">
                            {{if .Criticality}}
                            <span class="inline-flex items-center justify-center w-8 h-8 rounded-md text-sm font-bold border-2 bg-white" style="border-color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}}; color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}};">{{.Criticality.Score}}</span>
                            {{end}}
                        </td>
                        <td class="p-3 border-b border-gray-300 align-top w-2/5">
                            <ul class="list-disc pl-5 m-0">
                                {{range .FindingItems}}
                                {{if and (eq .DisplayAs "link") .Values}}
                                    {{$name := .DisplayName}}
                                    {{range .Values}}
                                    <li class="py-0.5 text-xs"><a href="{{.}}" target="_blank" class="text-blue-600 no-underline font-medium hover:text-blue-800 hover:underline">{{$name}}</a></li>
                                    {{end}}
                                {{else}}
                                <li class="py-0.5 text-xs text-gray-600">{{.DisplayName}}</li>
                                {{end}}
                                {{end}}
                            </ul>
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}

        <!-- AI Services -->
        {{if .AIAssetsFound}}
        <div class="my-7">
            <h2 class="text-gray-800 text-2xl mb-5 font-bold">AI Services Discovered</h2>
            <table class="w-full border-collapse bg-white border border-gray-300 rounded-xl overflow-hidden">
                <thead>
                    <tr class="bg-gray-50">
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Application</th>
                        <th class="text-center p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300 w-20">Criticality</th>
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Findings</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .AIAssetsFound}}
                    <tr class="even:bg-gray-50">
                        <td class="p-3 border-b border-gray-300 align-top text-[13px]">
                            <a href="https://{{.Domain}}" target="_blank" class="font-bold text-gray-700 hover:text-blue-600 no-underline">{{.Domain}}</a>
                        </td>
                        <td class="p-3 border-b border-gray-300 text-center align-top">
                            {{if .Criticality}}
                            <span class="inline-flex items-center justify-center w-8 h-8 rounded-md text-sm font-bold border-2 bg-white" style="border-color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}}; color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}};">{{.Criticality.Score}}</span>
                            {{end}}
                        </td>
                        <td class="p-3 border-b border-gray-300 align-top w-2/5">
                            <ul class="list-disc pl-5 m-0">
                                {{range .FindingItems}}
                                {{if and (eq .DisplayAs "link") .Values}}
                                    {{$name := .DisplayName}}
                                    {{range .Values}}
                                    <li class="py-0.5 text-xs"><a href="{{.}}" target="_blank" class="text-blue-600 no-underline font-medium hover:text-blue-800 hover:underline">{{$name}}</a></li>
                                    {{end}}
                                {{else}}
                                <li class="py-0.5 text-xs text-gray-600">{{.DisplayName}}</li>
                                {{end}}
                                {{end}}
                            </ul>
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}

        <!-- Web Applications -->
        {{if .WebAppsFound}}
        <div class="my-7">
            <h2 class="text-gray-800 text-2xl mb-5 font-bold">Web Applications Discovered</h2>

            <div class="bg-white border border-gray-200 rounded-lg p-3 mb-4 flex items-center gap-2 text-[11px]">
                <span class="font-semibold text-gray-800">Asset Criticality Score:</span>
                <div class="flex items-center gap-2">
                    <span class="text-gray-600">Highest</span>
                    <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#a0302e] text-[#a0302e] bg-white">5</span>
                    <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#d97706] text-[#d97706] bg-white">4</span>
                    <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#ea580c] text-[#ea580c] bg-white">3</span>
                    <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#84cc16] text-[#84cc16] bg-white">2</span>
                    <span class="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold border-2 border-[#10b981] text-[#10b981] bg-white">1</span>
                    <span class="text-gray-600">Lowest</span>
                </div>
            </div>

            <table class="w-full border-collapse bg-white border border-gray-300 rounded-xl overflow-hidden">
                <thead>
                    <tr class="bg-gray-50">
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Application</th>
                        <th class="text-center p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300 w-20">Criticality</th>
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Findings</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .WebAppsFound}}
                    <tr class="even:bg-gray-50">
                        <td class="p-3 border-b border-gray-300 align-top text-[13px]">
                            <a href="https://{{.Domain}}" target="_blank" class="font-bold text-gray-700 hover:text-blue-600 no-underline block">{{.Domain}}</a>
                            {{if .Title}}
                            <div class="text-xs font-medium text-gray-600 mt-1">{{.Title}}</div>
                            {{end}}
                            {{if .Description}}
                            <div class="text-[11px] text-gray-500 mt-1 leading-relaxed">{{.Description}}</div>
                            {{end}}
                        </td>
                        <td class="p-3 border-b border-gray-300 text-center align-top">
                            {{if .Criticality}}
                            <span class="inline-flex items-center justify-center w-8 h-8 rounded-md text-sm font-bold border-2 bg-white" style="border-color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}}; color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}};">{{.Criticality.Score}}</span>
                            {{end}}
                        </td>
                        <td class="p-3 border-b border-gray-300 align-top w-2/5">
                            <ul class="list-disc pl-5 m-0">
                                {{if and (eq (len .FindingItems) 1) (eq (index .FindingItems 0).DisplayName "Web Server")}}
                                <li class="py-0.5 text-xs text-gray-600">Standard web application</li>
                                {{else}}
                                {{range .FindingItems}}
                                {{if and (eq .DisplayAs "link") .Values}}
                                    {{$name := .DisplayName}}
                                    {{range .Values}}
                                    <li class="py-0.5 text-xs"><a href="{{.}}" target="_blank" class="text-blue-600 no-underline font-medium hover:text-blue-800 hover:underline">{{$name}}</a></li>
                                    {{end}}
                                {{else}}
                                <li class="py-0.5 text-xs text-gray-600">{{.DisplayName}}</li>
                                {{end}}
                                {{end}}
                                {{end}}
                            </ul>
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}

        <!-- Other Domains -->
        {{if .OtherDomains}}
        <div class="my-7">
            <h2 class="text-gray-800 text-2xl mb-5 font-bold">Other Domains Discovered</h2>
            <table class="w-full border-collapse bg-white border border-gray-300 rounded-xl overflow-hidden">
                <thead>
                    <tr class="bg-gray-50">
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Domain</th>
                        <th class="text-center p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300 w-20">Criticality</th>
                        <th class="text-left p-3 font-semibold text-[13px] text-gray-600 border-b border-gray-300">Findings</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .OtherDomains}}
                    <tr class="even:bg-gray-50">
                        <td class="p-3 border-b border-gray-300 align-top text-[13px]">
                            <a href="https://{{.Domain}}" target="_blank" class="font-bold text-gray-700 hover:text-blue-600 no-underline block">{{.Domain}}</a>
                            {{if .Title}}
                            <div class="text-xs font-medium text-gray-600 mt-1">{{.Title}}</div>
                            {{end}}
                            {{if .Description}}
                            <div class="text-[11px] text-gray-500 mt-1 leading-relaxed">{{.Description}}</div>
                            {{end}}
                        </td>
                        <td class="p-3 border-b border-gray-300 text-center align-top">
                            {{if .Criticality}}
                            <span class="inline-flex items-center justify-center w-8 h-8 rounded-md text-sm font-bold border-2 bg-white" style="border-color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}}; color: {{if eq .Criticality.Score 5}}#a0302e{{else if eq .Criticality.Score 4}}#d97706{{else if eq .Criticality.Score 3}}#ea580c{{else if eq .Criticality.Score 2}}#84cc16{{else}}#10b981{{end}};">{{.Criticality.Score}}</span>
                            {{end}}
                        </td>
                        <td class="p-3 border-b border-gray-300 align-top w-2/5">
                            {{if .FindingItems}}
                            <ul class="list-disc pl-5 m-0">
                                {{range .FindingItems}}
                                {{if and (eq .DisplayAs "link") .Values}}
                                    {{$name := .DisplayName}}
                                    {{range .Values}}
                                    <li class="py-0.5 text-xs"><a href="{{.}}" target="_blank" class="text-blue-600 no-underline font-medium hover:text-blue-800 hover:underline">{{$name}}</a></li>
                                    {{end}}
                                {{else}}
                                <li class="py-0.5 text-xs text-gray-600">{{.DisplayName}}</li>
                                {{end}}
                                {{end}}
                            </ul>
                            {{end}}
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        {{end}}

        <!-- Technology Details -->
        {{if and .Technologies .Technologies.AllTechnologies (gt (len .Technologies.AllTechnologies) 0)}}
        <div class="my-7 break-before-page">
            <h2 class="text-gray-800 text-2xl mb-6 font-bold">Technology Exposure</h2>
            <div class="flex flex-col gap-5">
                {{range .Technologies.AllTechnologies}}
                <div class="bg-white border border-gray-300 rounded-xl p-5 flex gap-5">
                    <div class="flex-shrink-0 w-15 h-15 flex items-center justify-center">
                        <img src="./assets/{{.Icon}}" alt="{{.DisplayName}}" class="w-10 h-10 object-contain" onerror="this.style.display='none'">
                    </div>
                    <div class="flex-1 flex flex-col gap-2">
                        <div class="flex justify-between items-center">
                            <span class="text-base font-bold text-gray-700">{{.DisplayName}}</span>
                            <span class="text-sm font-semibold text-gray-600 bg-gray-100 px-3 py-1 rounded-lg">Used by {{.Count}} {{if eq .Count 1}}domain{{else}}domains{{end}}</span>
                        </div>
                        {{if .Description}}
                        <div class="text-[13px] text-gray-600 leading-relaxed">{{.Description}}</div>
                        {{end}}
                        {{if .Labels}}
                        <div class="flex gap-2 flex-wrap mt-1">
                            {{range .Labels}}
                            <span class="text-[11px] font-medium text-indigo-600 bg-indigo-50 px-2.5 py-0.5 rounded-md">{{.}}</span>
                            {{end}}
                        </div>
                        {{end}}
                        {{if .Security}}
                        {{if or (and .Security.CVE (gt .Security.CVE.Stats.Total 0)) (and .Security.Weaknesses (gt .Security.Weaknesses.Stats.Total 0))}}
                        <div class="mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200">
                            {{if .Security.CVE}}
                            {{if gt .Security.CVE.Stats.Total 0}}
                            <div class="mb-2.5">
                                <div class="text-[11px] font-bold text-gray-700 uppercase tracking-wide mb-1.5">Known Vulnerabilities (CVE)</div>
                                <div class="flex gap-1.5 items-center flex-wrap">
                                    {{if gt .Security.CVE.Stats.Critical 0}}
                                    <span class="inline-flex items-center justify-center min-w-8 h-5 px-2 rounded text-[11px] font-bold text-white bg-red-600">{{.Security.CVE.Stats.Critical}} Critical</span>
                                    {{end}}
                                    {{if gt .Security.CVE.Stats.High 0}}
                                    <span class="inline-flex items-center justify-center min-w-8 h-5 px-2 rounded text-[11px] font-bold text-white bg-orange-600">{{.Security.CVE.Stats.High}} High</span>
                                    {{end}}
                                    {{if gt .Security.CVE.Stats.Medium 0}}
                                    <span class="inline-flex items-center justify-center min-w-8 h-5 px-2 rounded text-[11px] font-bold text-white bg-yellow-500">{{.Security.CVE.Stats.Medium}} Medium</span>
                                    {{end}}
                                    {{if gt .Security.CVE.Stats.Low 0}}
                                    <span class="inline-flex items-center justify-center min-w-8 h-5 px-2 rounded text-[11px] font-bold text-white bg-lime-500">{{.Security.CVE.Stats.Low}} Low</span>
                                    {{end}}
                                    {{if gt .Security.CVE.Stats.KEV 0}}
                                    <span class="inline-flex items-center justify-center min-w-8 h-5 px-2 rounded text-[11px] font-bold text-white bg-purple-600">{{.Security.CVE.Stats.KEV}} KEV</span>
                                    {{end}}
                                </div>
                            </div>
                            {{end}}
                            {{end}}
                            {{if .Security.Weaknesses}}
                            {{if gt .Security.Weaknesses.Stats.Total 0}}
                            <div>
                                <div class="text-[11px] font-bold text-gray-700 uppercase tracking-wide mb-1.5">Common Weaknesses (CWE)</div>
                                <div class="flex flex-col gap-1">
                                    {{range .Security.Weaknesses.Stats.TopCategories}}
                                    <div class="text-[11px] text-gray-700">
                                        <span class="font-bold text-indigo-600 font-mono">{{.ID}}:</span>
                                        <span class="font-medium text-gray-800">{{.Name}}</span>
                                        <span class="text-gray-600">({{.Count}} instances)</span>
                                    </div>
                                    {{end}}
                                </div>
                            </div>
                            {{end}}
                            {{end}}
                        </div>
                        {{end}}
                        {{end}}
                    </div>
                </div>
                {{end}}
            </div>
        </div>
        {{end}}

        <!-- Footer -->
        <footer class="mt-5 pt-2.5 border-t border-gray-300 text-center text-gray-500 text-[8px]">
            Â© 2025 Qualys, Inc. All rights reserved | Confidential and Proprietary Information
        </footer>
    </div>
</body>
</html>
